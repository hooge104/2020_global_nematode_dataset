# Global database of soil nematodes
This repository contains the code associated with the paper `A global database of soil nematode abundance and functional group composition`, doi: [10.1038/s41597-020-0437-3](https://doi.org/10.1038/s41597-020-0437-3). This dataset includes 6,825 georeferenced soil samples from all continents and biomes. For geospatial mapping purposes these samples are aggregated into 1,933 unique 1-km pixels, each of which is linked to 73 global environmental covariate data layers. 

## Data
All data are available via figshare, doi: [10.6084/m9.figshare.c.4718003](https://doi.org/10.6084/m9.figshare.c.4718003). Raw nematode abundance data (6,825 samples) are available as a csv file: “nematode_full_dataset_wBiome.csv”. Abundance data aggregated into 30 Arc-seconds pixels (1,933 unique locations), combined with environmental covariate data are available as a csv file: “nematode_abundance_aggregated_wCovar.csv”. Full metadata, including descriptions, units, and source information, of all global covariate layers are available as a csv file: “metadata.csv”.

## Code
All code was written in `R 3.6.1`.

## Metadata
In the folder `data` the following files can be found:

### Table S1:
`20191028_Nematode_v2_final.csv`

| Field           | Description                                         |
|-----------------|-----------------------------------------------------|
| Sample_ID       | Sample identifier                                   |
| Bacterivores    | Number of bacterivorous nematodes per 100g dry soil |
| Fungivores      | Number of fungivorous nematodes per 100g dry soil   |
| Herbivores      | Number of herbivorous nematodes per 100g dry soil   |
| Omnivores       | Number of omnivorous nematodes per 100g dry soil    |
| Predators       | Number of predatory nematodes per 100g dry soil     |
| Unidentified    | Number of unidentified nematodes per 100g dry soil  |
| Total_Number    | Total number of nematodes per 100g dry soil         |
| Latitude        | Latitude in WGS84                                   |
| Longitude       | Longitude in WGS84                                  |
| Pixel_Lat       | Pixel latitude in WGS84                             |
| Pixel_Long      | Pixel longitude in WGS84                            |
| WWF_Biome       | WWF Biome classification                            |
| sampling method | Sampling method                                     |
| DOI/URL         | Reference including doi where available             |
| Data_provider   | Original data provider                              |


### Table S2:
`20191029_nematode_aggretatedPixelValues_wBiome.csv`

| Band_Name                                      | Description                                                                                              | Layer_Group             | Units                                                          | Source                                                                                             |
|------------------------------------------------|----------------------------------------------------------------------------------------------------------|-------------------------|----------------------------------------------------------------|----------------------------------------------------------------------------------------------------|
| Aridity_Index                                  | Global AI (Aridity Index)                                                                                | Process                 | AI Value                                                       | http://www.cgiar-csi.org/data/global-aridity-and-pet-database                                      |
| CliMond_Annual_Mean_Radiation                  | Annual_Mean_Radiation                                                                                    | Atmospheric/Topographic | W m-2d-1                                                       | https://www.climond.org/BioclimRegistry.aspx#BioclimFAQ                                            |
| CliMond_Highest_Weekly_Radiation               | Highest_Weekly_Radiation                                                                                 | Atmospheric/Topographic | W m-2d-1                                                       | https://www.climond.org/BioclimRegistry.aspx#BioclimFAQ                                            |
| CliMond_Lowest_Weekly_Radiation                | Lowest_Weekly_Radiation                                                                                  | Atmospheric/Topographic | W m-2d-1                                                       | https://www.climond.org/BioclimRegistry.aspx#BioclimFAQ                                            |
| CliMond_Radiation_Seasonality                  | Radiation_Seasonality                                                                                    | Atmospheric/Topographic | W m-2d-1                                                       | https://www.climond.org/BioclimRegistry.aspx#BioclimFAQ                                            |
| CliMond_Radiation_of_Coldest_Quarter           | Radiation_of_Coldest_Quarter                                                                             | Atmospheric/Topographic | W m-2d-1                                                       | https://www.climond.org/BioclimRegistry.aspx#BioclimFAQ                                            |
| CliMond_Radiation_of_Driest_Quarter            | Radiation_of_Driest_Quarter                                                                              | Atmospheric/Topographic | W m-2d-1                                                       | https://www.climond.org/BioclimRegistry.aspx#BioclimFAQ                                            |
| CliMond_Radiation_of_Warmest_Quarter           | Radiation_of_Warmest_Quarter                                                                             | Atmospheric/Topographic | W m-2d-1                                                       | https://www.climond.org/BioclimRegistry.aspx#BioclimFAQ                                            |
| CliMond_Radiation_of_Wettest_Quarter           | Radiation_of_Wettest_Quarter                                                                             | Atmospheric/Topographic | W m-2d-1                                                       | https://www.climond.org/BioclimRegistry.aspx#BioclimFAQ                                            |
| EVI                                            | MYD13Q1.006 Vegetation Indices 16-Day Global 250m: NDVI and EVI                                          | Vegetative              | EVI Value                                                      | https://explorer.earthengine.google.com/#detail/MODIS%2F006%2FMYD13Q1                              |
| EarthEnvTexture_CoOfVar_EVI                    | Coefficient of variation (EVI Heterogeneity); Normalized dispersion of EVI                               | Process                 | >=0                                                            | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Contrast_EVI                   | Contrast (EVI Heterogeneity); Exponentially weighted difference in EVI between adjacent pixels           | Process                 | >=0                                                            | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Correlation_EVI                | Correlation (EVI Heterogeneity); Linear dependency of EVI on adjacent pixels                             | Process                 | >=-1; <=1                                                      | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Dissimilarity_EVI              | Dissimilarity (EVI Heterogeneity); Difference in EVI between adjacent pixels                             | Process                 | >=0                                                            | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Entropy_EVI                    | Entropy (EVI Heterogeneity); Disorderliness of EVI                                                       | Process                 | >=0                                                            | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Evenness_EVI                   | Evenness (EVI Heterogeneity); Evenness of EVI                                                            | Process                 | >=0; <=1                                                       | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Homogeneity_EVI                | Homogeneity (EVI Heterogeneity); Similarity of EVI between adjacent pixels                               | Process                 | >=0; <=1                                                       | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Maximum_EVI                    | Maximum (EVI Heterogeneity); Dominance of EVI combinations between adjacent pixels                       | Process                 | >=0; <=1                                                       | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Range_EVI                      | Range (EVI Heterogeneity); Range of EVI                                                                  | Process                 | >=0                                                            | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Shannon_Index                  | Shannon (EVI Heterogeneity); Diversity of EVI                                                            | Process                 | >=0; <=ln(max # of different EVI)                              | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Simpson_Index                  | Simpson (EVI Heterogeneity); Diversity of EVI                                                            | Process                 | >=0; <=1-1/(max # of different EVI)                            | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Std_EVI                        | Standard deviation (EVI Heterogeneity); Dispersion of EVI                                                | Process                 | >=0                                                            | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Uniformity_EVI                 | Uniformity (EVI Heterogeneity); Orderliness of EVI                                                       | Process                 | >=0; <=1                                                       | http://www.earthenv.org/texture                                                                    |
| EarthEnvTexture_Variance_EVI                   | Variance                                                                                                 | Process                 | >=0                                                            | http://www.earthenv.org/texture                                                                    |
| EarthEnvTopoMed_Eastness                       | Eastness                                                                                                 | Topography              | eastness index (-1 to 1)                                       | https://www.earthenv.org/topography                                                                |
| EarthEnvTopoMed_Elevation                      | Elevation (in meters)                                                                                    | Topography              | meters                                                         | https://www.earthenv.org/topography                                                                |
| EarthEnvTopoMed_Hillshade                      | Hillshade                                                                                                | Topography              | grayscale value (shade)                                        | https://www.earthenv.org/topography                                                                |
| EarthEnvTopoMed_Northness                      | Northness                                                                                                | Topography              | northness index (-1 to 1)                                      | https://www.earthenv.org/topography                                                                |
| EarthEnvTopoMed_Slope                          | Slope                                                                                                    | Topography              | (see reference for more information on units)                  | https://www.earthenv.org/topography                                                                |
| Global_Biomass_IPCC                            | Global Biomass (IPCC Tier 1 Calculated Values) for 2000                                                  | Vegetative              | 0.01 tonnes of biomass carbon per hectare                      | http://cdiac.ess-dive.lbl.gov/epubs/ndp/global_carbon/carbon_documentation.html                    |
| Gpp                                            | MOD17A3.055: Terra Net Primary Production Yearly Global 1km (including Gross PP)                         | Process                 | GPP & NPP Values                                               | https://explorer.earthengine.google.com/#detail/MODIS%2F055%2FMOD17A3                              |
| Human_Development_Percentage                   | Percentage of urban/built-up areas summed with cultivated/managed vegetation (summed via composite code) | Process                 | percentage (0-100)                                             | https://www.earthenv.org/landcover                                                                 |
| NDVI                                           | MYD13Q1.006 Vegetation Indices 16-Day Global 250m: NDVI and EVI                                          | Vegetative              | EVI Value                                                      | https://explorer.earthengine.google.com/#detail/MODIS%2F006%2FMYD13Q1                              |
| Nadir_Reflectance_Band1                        | MCD43A4.005 BRDF-Adjusted Reflectance 16-Day Global 500m                                                 | Vegetative              | 7 bands of reflectance (abbreviated "Nadir_Reflectance_Bandx") | https://explorer.earthengine.google.com/#detail/MODIS%2FMCD43A4                                    |
| Nadir_Reflectance_Band2                        | MCD43A4.005 BRDF-Adjusted Reflectance 16-Day Global 500m                                                 | Vegetative              | 7 bands of reflectance (abbreviated "Nadir_Reflectance_Bandx") | https://explorer.earthengine.google.com/#detail/MODIS%2FMCD43A4                                    |
| Nadir_Reflectance_Band3                        | MCD43A4.005 BRDF-Adjusted Reflectance 16-Day Global 500m                                                 | Vegetative              | 7 bands of reflectance (abbreviated "Nadir_Reflectance_Bandx") | https://explorer.earthengine.google.com/#detail/MODIS%2FMCD43A4                                    |
| Nadir_Reflectance_Band4                        | MCD43A4.005 BRDF-Adjusted Reflectance 16-Day Global 500m                                                 | Vegetative              | 7 bands of reflectance (abbreviated "Nadir_Reflectance_Bandx") | https://explorer.earthengine.google.com/#detail/MODIS%2FMCD43A4                                    |
| Nadir_Reflectance_Band5                        | MCD43A4.005 BRDF-Adjusted Reflectance 16-Day Global 500m                                                 | Vegetative              | 7 bands of reflectance (abbreviated "Nadir_Reflectance_Bandx") | https://explorer.earthengine.google.com/#detail/MODIS%2FMCD43A4                                    |
| Nadir_Reflectance_Band6                        | MCD43A4.005 BRDF-Adjusted Reflectance 16-Day Global 500m                                                 | Vegetative              | 7 bands of reflectance (abbreviated "Nadir_Reflectance_Bandx") | https://explorer.earthengine.google.com/#detail/MODIS%2FMCD43A4                                    |
| Nadir_Reflectance_Band7                        | MCD43A4.005 BRDF-Adjusted Reflectance 16-Day Global 500m                                                 | Vegetative              | 7 bands of reflectance (abbreviated "Nadir_Reflectance_Bandx") | https://explorer.earthengine.google.com/#detail/MODIS%2FMCD43A4                                    |
| Npp                                            | MOD17A3.055: Terra Net Primary Production Yearly Global 1km (including Gross PP)                         | Process                 | GPP & NPP Values                                               | https://explorer.earthengine.google.com/#detail/MODIS%2F055%2FMOD17A3                              |
| PET                                            | Global PET (Potential Evapotranspiration)                                                                | Process                 | PET Value (mm)                                                 | http://www.cgiar-csi.org/data/global-aridity-and-pet-database                                      |
| Pixel_Lat                                      | The latitude value of the pixel's centroid                                                               | Process                 | Decimal degrees                                                | (produced from a generator image with the composite); ee.Image.pixelLonLat()                       |
| Pixel_Long                                     | The longitude value of the pixel's centroid                                                              | Process                 | Decimal degrees                                                | (produced from a generator image with the composite); ee.Image.pixelLonLat()                       |
| Population_Density                             | Gridded Population of the World, Version 4 (GPWv4): UN-Adjusted Population Density                       | Anthropogenic           | persons/km^2                                                   | https://explorer.earthengine.google.com/#detail/CIESIN%2FGPWv4%2Funwpp-adjusted-population-density |
| SG_Bulk_density_015cm                          | BLDFIE_M_sl3_250m_ll = Bulk density (fine earth) at 0.15m                                                | Soil                    | kg / cubic–meter                                               | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_CEC_015cm                                   | CECSOL_M_sl3_250m_ll = Cation exchange capacity of soil at 0.15m                                         | Soil                    | cmolc/kg                                                       | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_Clay_Content_015cm                          | CLYPPT_M_sl3_250m_ll= Clay content (0–2 micro meter) at 0.15m                                            | Soil                    | mass fraction in %                                             | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_Coarse_fragments_015cm                      | CRFVOL_M_sl3_250m_ll = Coarse fragments volumetric at 0.15m                                              | Soil                    | %                                                              | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_Depth_to_bedrock                            | BDRICM_M_250m_ll_b1 = Depth to Bedrock (up to 200cm)                                                     | Soil                    | cm (up to 200)                                                 | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_Probability_of_occurrence_of_R_horizon      | BDRLOG_M_250m_ll = Predicted Probability of Occurence (0-100%) in the R Horizon                          | Soil                    | (0-100)%                                                       | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_SOC_Content_015cm                           | ORCDRC_M_sl3_250m_ll = Soil organic carbon content (fine earth fraction) at 0.15m                        | Soil                    | g per kg                                                       | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_SOC_Stock_005cm_to_015cm                    | OCSTHA_M_sd2_250m_ll = Soil Organic Carbon Stock from 0.05m-0.15m                                        | Soil                    | tonnes per ha                                                  | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_Sand_Content_015cm                          | SNDPPT_M_sl3_250m_ll = Sand content (50–2000 micro meter) at 0.15m                                       | Soil                    | mass fraction in %                                             | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_Silt_Content_015cm                          | SLTPPT_M_sl3_250m_ll = Silt content (2–50 micro meter) at 0.15m                                          | Soil                    | mass fraction in %                                             | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| SG_Soil_pH_H2O_015cm                           | PHIHOX_M_sl3_250m_ll = Soil pH x 10 in H2O at 0.15m                                                      | Soil                    | pH x 10                                                        | https://www.soilgrids.org ; https://www.isric.org/explore/wosis/accessing-wosis-derived-datasets   |
| WorldClim2_Annual_Mean_Temperature             | WC01 / BIO01 = Annual Mean Temperature                                                                   | Climatic                | ºC                                                             | WorldClim2                                                                                         |
| WorldClim2_Annual_Precipitation                | WC12 / BIO12 = Annual Precipitation                                                                      | Climatic                | mm                                                             | WorldClim2                                                                                         |
| WorldClim2_Isothermality                       | WC03 / BIO03 = Isothermality (BIO2/BIO7) (* 100)                                                         | Climatic                | Unitless                                                       | WorldClim2                                                                                         |
| WorldClim2_Max_Temperature_of_Warmest_Month    | WC05 / BIO05 = Max Temperature of Warmest Month                                                          | Climatic                | ºC                                                             | WorldClim2                                                                                         |
| WorldClim2_Mean_Diurnal_Range                  | WC02 / BIO02 = Mean Diurnal Range (Mean of monthly (max temp - min temp))                                | Climatic                | ºC                                                             | WorldClim2                                                                                         |
| WorldClim2_Mean_Temperature_of_Coldest_Quarter | WC11 / BIO11 = Mean Temperature of Coldest Quarter                                                       | Climatic                | mm                                                             | WorldClim2                                                                                         |
| WorldClim2_Mean_Temperature_of_Driest_Quarter  | WC09 / BIO09 = Mean Temperature of Driest Quarter                                                        | Climatic                | ºC                                                             | WorldClim2                                                                                         |
| WorldClim2_Mean_Temperature_of_Warmest_Quarter | WC10 / BIO10 = Mean Temperature of Warmest Quarter                                                       | Climatic                | ºC                                                             | WorldClim2                                                                                         |
| WorldClim2_Mean_Temperature_of_Wettest_Quarter | WC08 / BIO08 = Mean Temperature of Wettest Quarter                                                       | Climatic                | ºC                                                             | WorldClim2                                                                                         |
| WorldClim2_Min_Temperature_of_Coldest_Month    | WC06 / BIO06 = Min Temperature of Coldest Month                                                          | Climatic                | ºC                                                             | WorldClim2                                                                                         |
| WorldClim2_Precipitation_Seasonality           | WC15 / BIO15 = Precipitation Seasonality (Coefficient of Variation)                                      | Climatic                | mm                                                             | WorldClim2                                                                                         |
| WorldClim2_Precipitation_of_Coldest_Quarter    | WC19 / BIO19 = Precipitation of Coldest Quarter                                                          | Climatic                | mm                                                             | WorldClim2                                                                                         |
| WorldClim2_Precipitation_of_Driest_Month       | WC14 / BIO14 = Precipitation of Driest Month                                                             | Climatic                | mm                                                             | WorldClim2                                                                                         |
| WorldClim2_Precipitation_of_Driest_Quarter     | WC17 / BIO17 = Precipitation of Driest Quarter                                                           | Climatic                | mm                                                             | WorldClim2                                                                                         |
| WorldClim2_Precipitation_of_Warmest_Quarter    | WC18 / BIO18 = Precipitation of Warmest Quarter                                                          | Climatic                | mm                                                             | WorldClim2                                                                                         |
| WorldClim2_Precipitation_of_Wettest_Month      | WC13 / BIO13 = Precipitation of Wettest Month                                                            | Climatic                | mm                                                             | WorldClim2                                                                                         |
| WorldClim2_Precipitation_of_Wettest_Quarter    | WC16 / BIO16 = Precipitation of Wettest Quarter                                                          | Climatic                | mm                                                             | WorldClim2                                                                                         |
| WorldClim2_Temperature_Annual_Range            | WC07 / BIO07 = Temperature Annual Range (BIO5-BIO6)                                                      | Climatic                | ºC                                                             | WorldClim2                                                                                         |
| WorldClim2_Temperature_Seasonality             | WC04 / BIO04 = Temperature Seasonality (standard deviation *100)                                         | Climatic                | ºC                                                             | WorldClim2                                                                                         |
